# 智慧社区项目 - 外部访问快速使用指南

## 🚀 一键启动

现在您可以使用统一管理脚本轻松管理智慧社区项目的外部访问！

### 📋 快速命令

```bash
# 启动外部访问服务
./external-manager.sh start

# 检查服务状态
./external-manager.sh status

# 测试API功能
./external-manager.sh test

# 停止服务
./external-manager.sh stop

# 重启服务
./external-manager.sh restart

# 查看帮助
./external-manager.sh help
```

## 🎯 主要功能

### 1. 启动服务
```bash
./external-manager.sh start
```
- 自动检测服务器IP
- 构建前后端项目
- 启动外部访问服务
- 显示访问地址和账户信息

### 2. 状态检查
```bash
./external-manager.sh status
```
- 检查进程运行状态
- 验证端口占用情况
- 测试服务响应
- 显示访问地址

### 3. API测试
```bash
./external-manager.sh test
```
- 测试后端健康检查
- 验证API接口功能
- 检查CORS配置
- 测试前端页面访问

### 4. 日志查看
```bash
# 查看后端日志
./external-manager.sh logs backend

# 查看前端日志
./external-manager.sh logs frontend

# 查看所有日志
./external-manager.sh logs
```

### 5. 服务管理
```bash
# 停止服务
./external-manager.sh stop

# 重启服务
./external-manager.sh restart

# 仅构建项目
./external-manager.sh build
```

## 📱 访问地址

### 移动端访问
- **前端应用**: `http://123.56.64.5:5173`
- **后端API**: `http://123.56.64.5:3000/api`

### 电脑端访问
- **前端应用**: `http://localhost:5173`
- **后端API**: `http://localhost:3000/api`

### 健康检查
- **后端健康**: `http://123.56.64.5:3000/health`
- **API健康**: `http://123.56.64.5:3000/api/health`

## 👥 演示账户

| 角色 | 邮箱 | 密码 |
|------|------|------|
| 业主 | `resident@example.com` | `password123` |
| 物业 | `property@example.com` | `property123` |
| 管理员 | `admin@example.com` | `admin123` |

## 🔧 故障排除

### 1. 服务启动失败
```bash
# 检查依赖
cd backend && npm install
cd ../frontend && npm install

# 重新启动
./external-manager.sh restart
```

### 2. 端口被占用
```bash
# 停止所有服务
./external-manager.sh stop

# 重新启动
./external-manager.sh start
```

### 3. 无法外部访问
```bash
# 检查服务状态
./external-manager.sh status

# 测试API
./external-manager.sh test

# 检查防火墙和安全组设置
```

### 4. 查看错误日志
```bash
# 查看后端日志
./external-manager.sh logs backend

# 查看前端日志
./external-manager.sh logs frontend
```

## 📊 监控和维护

### 定期检查
```bash
# 每天检查服务状态
./external-manager.sh status

# 定期测试API功能
./external-manager.sh test
```

### 日志管理
```bash
# 查看日志文件
ls -la logs/

# 清理旧日志（可选）
find logs/ -name "*external*.log" -mtime +7 -delete
```

### 服务重启
```bash
# 定期重启服务（建议每周）
./external-manager.sh restart
```

## 🎨 特色功能

### 1. 智能IP检测
- 自动检测服务器公网IP
- 支持多种IP获取方式
- 自动配置CORS策略

### 2. 统一进程管理
- PID文件管理
- 优雅的服务停止
- 端口冲突自动处理

### 3. 完整的监控
- 进程状态检查
- 端口占用监控
- 服务响应验证
- 外部访问测试

### 4. 友好的用户界面
- 彩色日志输出
- 清晰的状态显示
- 详细的帮助信息
- 中英文命令支持

## 📝 注意事项

1. **首次使用**：确保已安装项目依赖
2. **网络配置**：检查防火墙和安全组设置
3. **资源监控**：定期检查服务器资源使用情况
4. **数据备份**：定期备份数据库和上传文件
5. **安全考虑**：生产环境建议配置具体的CORS域名

## 🔗 相关文件

- `external-manager.sh` - 统一管理脚本
- `start-external-access.sh` - 原始启动脚本
- `stop-external-access.sh` - 原始停止脚本
- `check-external-status.sh` - 状态检查脚本
- `test-external-api.sh` - API测试脚本
- `docs/外部访问配置指南.md` - 详细配置指南

## 🆘 获取帮助

```bash
# 查看完整帮助
./external-manager.sh help

# 查看当前状态
./external-manager.sh status

# 测试所有功能
./external-manager.sh test
```

---

**🎉 现在您可以轻松管理智慧社区项目的外部访问了！** 