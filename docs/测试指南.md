# 智慧moma生活平台 - 功能测试指南

## 系统状态

✅ **后端服务**: 运行在 http://localhost:3000  
✅ **前端服务**: 运行在 http://localhost:5174  
✅ **数据库**: 已配置并包含测试数据  

## 测试账户

### 1. 超级管理员账户
- **邮箱**: `superadmin@example.com`
- **密码**: `admin`
- **权限**: 完整管理权限，可以管理用户、认证、密码重置等

### 2. 物业管理账户
- **邮箱**: `property@example.com`
- **密码**: `property123`
- **权限**: 物业管理功能，可以处理建议、发布公告等

### 3. 业主账户（已认证）
- **邮箱**: `resident@example.com`
- **密码**: `password123`
- **权限**: 普通用户功能，已通过身份认证
- **特点**: 该用户已认证，会显示认证标识

## 功能测试清单

### 1. 认证标识显示功能

#### 测试步骤：
1. **登录业主账户** (`resident@example.com` / `password123`)
2. **进入建议反馈页面**
   - 发布一条新建议
   - 查看建议列表，确认提交者名字旁有蓝色认证标识 ✓
   - 为其他建议添加评论
   - 查看评论区，确认已认证用户的评论显示认证标识 ✓

3. **进入闲置市场页面**
   - 发布一件闲置物品
   - 查看物品列表，确认卖家名字旁有认证标识 ✓
   - 为其他物品添加评论
   - 查看评论区，确认已认证用户的评论显示认证标识 ✓
   - 点击物品查看详情，确认详情页也显示卖家认证标识 ✓

### 2. 管理员密码重置功能

#### 测试步骤：
1. **登录超级管理员账户** (`superadmin@example.com` / `admin`)
2. **进入管理后台**
   - 点击"用户管理"标签
   - 在用户列表中找到任意用户
   - 点击用户行末的紫色齿轮图标（密码重置按钮）✓
   - 在弹出的模态框中输入新密码（至少6位字符）
   - 点击"重置密码"按钮
   - 确认显示成功消息 ✓

3. **验证密码重置**
   - 退出管理员账户
   - 使用刚才重置的用户账户和新密码登录
   - 确认可以成功登录 ✓

### 3. 闲置物品下架功能

#### 测试步骤：
1. **登录任意用户账户**
2. **发布闲置物品**
   - 进入闲置市场页面
   - 点击"发布闲置"按钮
   - 填写物品信息并上传图片
   - 提交发布

3. **下架物品**
   - 点击"我的物品"按钮
   - 在弹出的模态框中查看自己发布的物品
   - 点击物品的"删除"按钮（红色垃圾桶图标）✓
   - 在确认对话框中点击"确定"
   - 确认物品从列表中消失 ✓
   - 返回市场主页，确认物品也从主列表中消失 ✓

### 4. 管理员市场管理功能

#### 测试步骤：
1. **登录超级管理员账户** (`superadmin@example.com` / `admin`)
2. **进入管理后台**
   - 点击"市场管理"标签
   - 查看所有用户发布的物品列表
   - 确认卖家列中显示认证标识（如果卖家已认证）✓
   - 点击"查看"按钮查看物品详情
   - 在详情模态框中确认卖家信息显示认证标识 ✓
   - 点击"删除"按钮删除不当物品（管理员权限）✓

### 5. 图片跨域问题修复验证

#### 测试步骤：
1. **登录任意用户账户**
2. **查看用户个人信息**
   - 进入个人中心或用户资料页面
   - 查看身份证明材料图片
   - 确认图片可以正常加载，没有跨域错误 ✓

3. **发布带图片的物品**
   - 上传物品图片
   - 确认图片在发布后可以正常显示 ✓

## 预期结果

### 认证标识
- ✅ 已认证用户在所有相关位置都显示蓝色 CheckBadge 图标
- ✅ 未认证用户不显示任何认证标识
- ✅ 鼠标悬停在认证图标上显示"已认证用户"提示

### 密码重置
- ✅ 只有管理员可以看到密码重置按钮
- ✅ 密码长度验证正常工作（至少6位字符）
- ✅ 重置后的密码立即生效
- ✅ 显示成功/失败消息

### 物品下架
- ✅ 用户只能删除自己发布的物品
- ✅ 删除操作需要二次确认
- ✅ 删除后物品从所有相关列表中消失
- ✅ 相关评论和点赞数据也被清理

### 管理员功能
- ✅ 管理员可以查看和删除所有物品
- ✅ 管理界面正确显示认证状态
- ✅ 操作权限控制正常

## 故障排除

### 登录问题
如果遇到登录问题，请检查：
1. 确认使用正确的邮箱和密码
2. 检查后端服务是否运行（访问 http://localhost:3000/health）
3. 检查前端服务是否运行（访问 http://localhost:5174）

### 图片加载问题
如果图片无法加载：
1. 检查图片文件是否存在于 `backend/uploads/` 目录
2. 确认后端静态文件服务正常运行
3. 检查浏览器控制台是否有CORS错误

### 认证标识不显示
如果认证标识不显示：
1. 确认用户的 `is_verified` 字段为 1
2. 检查前端是否正确接收到认证状态数据
3. 确认 CheckBadgeIcon 组件正确导入

## 技术支持

如果在测试过程中遇到问题，请：
1. 检查浏览器控制台的错误信息
2. 查看后端服务日志
3. 确认数据库数据完整性
4. 验证网络连接和端口访问

---

**测试环境**: 开发环境  
**最后更新**: 2024年12月19日  
**版本**: v1.2.0 